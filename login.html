<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Login - SustentArte</title>
<style>
  hr.divider {
  margin: 18px 0;
  border: none;
  height: 2px;
  background-color: #2e7d32; /* verde escuro da paleta */
  opacity: 0.6;
  border-radius: 2px;
}

.btn-cadastrar {
  width: 100%;
  padding: 14px;
  border-radius: 10px;
  border: 2px solid #2e7d32;
  background: #dff5cf;
  color: #2e7d32;
  font-weight: 700;
  font-size: 1rem;
  cursor: pointer;
  transition: all 0.2s ease;
}

.btn-cadastrar:hover {
  background: #c8ebbc;
  transform: scale(1.02);
}

  :root{
    --mascote-h: 150px;
    --gap-top: 16px;
  }

  *{box-sizing: border-box;margin:0;padding:0}

  body{
    min-height:100vh;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    padding:20px;
    font-family: "Poppins", sans-serif;
    background: #b8f5b0;
    border: 10px solid #2e7d32;
    border-radius: 15px;
    box-shadow: inset 0 0 15px rgba(0,100,0,0.35);
    overflow:auto;
    position: relative;
  }

  .recycle-icon{position:absolute;width:80px;opacity:.07;pointer-events:none}
  .recycle1{top:8%;left:8%}
  .recycle2{bottom:10%;right:8%}
  .recycle3{top:50%;right:28%}

  .login-container{width:100%;max-width:440px;padding:12px;position:relative;z-index:1;flex:1;display:flex;align-items:center;justify-content:center;}

  .login-box{
    position:relative;
    background:#dff5cf;
    border:6px solid #2e7d32;
    border-radius:20px;
    box-shadow:0 8px 30px rgba(0,0,0,.18);
    padding: calc(var(--mascote-h) / 2 + var(--gap-top)) 28px 28px;
    text-align:center;
    color:#1b5e20;
  }

  .login-box .mascote{
    position:absolute;
    top:-36px;
    left:50%;
    transform: translate(-50%, -50%);
    width: var(--mascote-h);
    height: auto;
    z-index:2;
    pointer-events:none;
  }

  .login-box h2{font-size:1.6rem;margin-bottom:18px}
  .input-group{text-align:left;margin-bottom:16px}
  .input-group label{display:block;font-weight:700;color:#1b5e20;margin-bottom:6px;font-size:.95rem}
  .input-group input{
    width:100%;padding:12px;border-radius:10px;border:2px solid #81c784;background:#fff;color:#2e7d32;font-size:1rem;
  }
  .input-group input:focus{outline:none;box-shadow:0 0 6px rgba(67,160,71,.28);border-color:#43a047}

  .senha-wrapper{position:relative}
  .icone-olho{position:absolute;right:10px;top:50%;transform:translateY(-50%);width:26px;cursor:pointer}

  button[type="submit"]{
    width:100%;padding:14px;border-radius:10px;border:none;background:#43a047;color:#fff;font-weight:700;font-size:1rem;cursor:pointer;
  }
  button[type="submit"]:hover{background:#2e7d32}

  footer{
    width:100%;
    display:flex;
    align-items:center;
    justify-content:flex-start;
    padding:10px 20px;
    position: absolute;
    bottom: 0;
    left: 0;
  }

  footer img{
    height:40px;
    width:auto;
  }

  @media (max-width: 900px){
    :root{ --mascote-h: 140px }
    .login-box{ padding-left:22px;padding-right:22px }
  }

  @media (max-width: 600px){
    :root{ --mascote-h: 120px }
    .login-box{ padding-left:18px;padding-right:18px }
    .login-box h2{font-size:1.35rem}
    .icone-olho{width:22px}
  }

  @media (max-width: 400px){
    :root{ --mascote-h: 100px; --gap-top: 12px }
    .login-box{ padding-left:14px;padding-right:14px }
    .login-box h2{font-size:1.15rem}
  }

  @media (max-height: 600px){
    :root{ --mascote-h: 90px }
    .login-box{ padding-top: calc(var(--mascote-h) / 2 + var(--gap-top)) }
  }

  input, button{min-height:44px}
</style>
</head>
<body>

  <img src="recycle.png" class="recycle-icon recycle1" alt="">
  <img src="recycle.png" class="recycle-icon recycle2" alt="">
  <img src="recycle.png" class="recycle-icon recycle3" alt="">

  <div class="login-container">
    <div class="login-box">
      <img id="mascote" class="mascote" src="mascoteBlind.png" alt="Mascote">

      <h2>Login</h2>

      <form onsubmit="event.preventDefault(); handleLogin();">
        <div class="input-group">
          <label for="email">E-mail</label>
          <input id="email" type="email" placeholder="Digite seu e-mail">
        </div>

        <div class="input-group">
          <label for="senha">Senha</label>
          <div class="senha-wrapper">
            <input id="senha" type="password" placeholder="Digite sua senha">
            <img id="toggleSenha" class="icone-olho" src="olhoFechado.png" alt="Mostrar senha">
          </div>
        </div>
      <p class="esqueci-senha">
        <a href="#" id="esqueciSenhaLink">Esqueci minha senha</a>
      </p>

       <button type="submit">Entrar</button>

<hr class="divider">

<button type="button" class="btn-cadastrar" onclick="window.location.href='cadastro.html'">
  Cadastrar
</button>

      </form>
    </div>
  </div>

  <footer>
    <img src="logo-crescimento.png" alt="Logo Crescimento">
  </footer>

<script type="module">
  // Importa o cliente do Supabase
  import { createClient } from 'https://esm.sh/@supabase/supabase-js@2';

  // üîë Coloca aqui as tuas credenciais
  const supabaseUrl = 'https://afobiejrsjolurxeqnuz.supabase.co';
  const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFmb2JpZWpyc2pvbHVyeGVxbnV6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI1NTkxMDAsImV4cCI6MjA3ODEzNTEwMH0.dhHgjXnOzZE5f3HDBzgBjuZss33LrGPuM1ckKeG6-bw';
  const supabase = createClient(supabaseUrl, supabaseKey);

  // Refer√™ncias aos elementos
  const senhaInput = document.getElementById('senha');
  const toggleSenha = document.getElementById('toggleSenha');
  const mascote = document.getElementById('mascote');
  const form = document.querySelector('form');

  // Alternar visibilidade da senha
  toggleSenha.addEventListener('click', () => {
    const isPassword = senhaInput.type === 'password';
    senhaInput.type = isPassword ? 'text' : 'password';
    toggleSenha.src = isPassword ? 'olhoAberto.png' : 'olhoFechado.png';
    mascote.src = isPassword ? 'mascote.png' : 'mascoteBlind.png';
  });

  // Fun√ß√£o de login via Supabase
  form.addEventListener('submit', async (e) => {
    e.preventDefault();

    const email = document.getElementById('email').value.trim();
    const password = senhaInput.value.trim();

    if (!email || !password) {
      alert('Por favor, preencha todos os campos.');
      return;
    }

    // üîê Login com Supabase
    const { data, error } = await supabase.auth.signInWithPassword({
      email,
      password,
    });

    if (error) {
      console.error(error);
      alert('Usu√°rio ou senha incorretos.');
      return;
    }

    alert('Login realizado com sucesso!');
    window.location.href = 'home.html';
  });
</script>
<div id="resetBox" class="floating-box" style="display:none;">
  <h3>Recuperar senha</h3>
  <p>Digite seu e-mail e enviaremos um link de redefini√ß√£o.</p>
  <input type="email" id="resetEmail" placeholder="Seu e-mail" required>
  <div class="actions">
    <button id="enviarReset">Enviar</button>
    <button id="cancelarReset" class="cancel">Cancelar</button>
  </div>
</div>

<style>
  .esqueci-senha {
    text-align:right;
    margin-bottom:10px;
  }
  .esqueci-senha a {
    color:#2e7d32;
    font-weight:600;
    text-decoration:none;
    font-size:0.9rem;
  }
  .esqueci-senha a:hover {
    text-decoration:underline;
  }

  .floating-box {
    position:fixed;
    top:50%;
    left:50%;
    transform:translate(-50%,-50%);
    background:#dff5cf;
    border:4px solid #2e7d32;
    border-radius:15px;
    box-shadow:0 6px 25px rgba(0,0,0,0.25);
    padding:20px;
    width:90%;
    max-width:340px;
    text-align:center;
    z-index:10;
  }
  .floating-box input {
    width:100%;
    margin:10px 0;
    padding:10px;
    border:2px solid #81c784;
    border-radius:8px;
    font-size:1rem;
  }
  .floating-box .actions {
    display:flex;
    justify-content:space-between;
    gap:10px;
  }
  .floating-box button {
    flex:1;
    padding:10px;
    border:none;
    border-radius:8px;
    font-weight:700;
    color:#fff;
    cursor:pointer;
  }
  #enviarReset { background:#43a047; }
  #enviarReset:hover { background:#2e7d32; }
  .cancel { background:#999; }
  .cancel:hover { background:#666; }
</style>

<script type="module">
  import { createClient } from 'https://esm.sh/@supabase/supabase-js@2';

  const supabase = createClient('https://afobiejrsjolurxeqnuz.supabase.co', 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFmb2JpZWpyc2pvbHVyeGVxbnV6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI1NTkxMDAsImV4cCI6MjA3ODEzNTEwMH0.dhHgjXnOzZE5f3HDBzgBjuZss33LrGPuM1ckKeG6-bw');

  const link = document.getElementById('esqueciSenhaLink');
  const box = document.getElementById('resetBox');
  const enviarBtn = document.getElementById('enviarReset');
  const cancelarBtn = document.getElementById('cancelarReset');

  link.addEventListener('click', (e)=>{
    e.preventDefault();
    box.style.display='block';
  });

  cancelarBtn.addEventListener('click', ()=> box.style.display='none');

  enviarBtn.addEventListener('click', async ()=>{
    const email = document.getElementById('resetEmail').value.trim();
    if(!email){
      alert('Digite um e-mail v√°lido.');
      return;
    }
    const { error } = await supabase.auth.resetPasswordForEmail(email, {
      redirectTo: "https://sr-junkie.github.io/SustentArte/nova-senha.html"
    });

    if(error){
      alert('Erro ao enviar e-mail: ' + error.message);
    }else{
      alert('Verifique sua caixa de entrada. Um link foi enviado para redefinir sua senha.');
      box.style.display='none';
    }
  });
</script>

</body>
</html>
